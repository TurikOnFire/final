<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>–ì–ª–∞–≤–Ω–∞—è</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<header>
    <h1>FINAL PROJECT</h1>
    <nav>
        <a th:href="@{/}">–ì–ª–∞–≤–Ω–∞—è</a>
        <a sec:authorize="!isAuthenticated()" th:href="@{/login}">–í–æ–π—Ç–∏</a>
        <a th:if="${#authorization.expression('isAuthenticated()')}" th:href="@{/logout}">–í—ã–π—Ç–∏</a>
    </nav>
</header>

<main>
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h2>
    <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
        <span th:text="${#authentication.name}"></span>
    </p>
    <p th:if="${#authorization.expression('isAuthenticated()')}">
        –í—ã –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É.
    </p>

    <p th:unless="${#authorization.expression('isAuthenticated()')}">
        –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.
    </p>
    <div sec:authorize="isAnonymous()" style="display: flex; justify-content: space-around">
        <a class="btn btn-info" th:href="@{/login}" style="width: 25%">–ü–µ—Ä–µ–π—Ç–∏ –∫ –ª–æ–≥–∏–Ω—É</a>
        <a class="btn btn-info" th:href="@{/registration}" style="width: 25%">–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</a>
    </div>

    <div sec:authorize="hasRole('USER')">
        <p>–ö–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</p>
    </div>
    <div sec:authorize="hasRole('ADMIN')">
        <a href="/users" class="btn btn-primary">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
    </div>
    <div sec:authorize="hasAnyRole('ADMIN', 'USER')" class="d-flex justify-content-center py-4">
        <table class="table position-relative">
            <tr>
                <th>Task Id</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
                <th>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
                <th>–î–µ–¥–ª–∞–π–Ω</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
            </tr>

            <tr th:each="task : ${tasks}" th:data-id="${task.id}">
                <td th:text="${task.id}"></td>
                <td class="editable" data-field="title" th:text="${task.title}"></td>
                <td class="editable" data-field="description" th:text="${task.description}"></td>
                <td class="editable" data-field="deadline" th:text="${task.deadline}"></td>
                <td class="editable" data-field="status" th:text="${task.status}"></td>
                <td th:text="${task.user.username}"></td>
            </tr>
        </table>
    </div>


</main>

<footer>
    <p>¬©JavaRush. Arthur Kuzin. 2025 FINAL</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>
