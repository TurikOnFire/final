<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<header >
    <h1>FINAL PROJECT</h1>
    <nav>
        <a th:href="@{/}">–ì–ª–∞–≤–Ω–∞—è</a>
        <a sec:authorize="!isAuthenticated()" th:href="@{/login}">–í–æ–π—Ç–∏</a>
        <a th:if="${#authorization.expression('isAuthenticated()')}" th:href="@{/logout}">–í—ã–π—Ç–∏</a>
    </nav>
</header>

<main>
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h2>
    <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
        <span th:text="${#authentication.name}"></span>
    </p>

    <div>
        <div class="d-flex flex-row">
            <H1>USERS</H1>
            <H1><a href="#"></a></H1>
        </div>
        <table class="table">
            <tr>
                <th>User Id</th>
                <th>–õ–æ–≥–∏–Ω</th>
                <th>–ü–∞—Ä–æ–ª—å</th>
                <th>–ü–æ—á—Ç–∞</th>
                <th>–†–æ–ª—å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>

            <tr th:each="user : ${users}">
                <td th:text="${user.id}"></td>
                <td th:text="${user.username}"></td>
                <td th:text="${user.password}"></td>
                <td th:text="${user.email}"></td>
                <td th:text="${user.role}"></td>
                <td>
                    <a th:href="@{/users/{id}(id=${user.id})}" class="btn w-50">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</a>
                </td>
            </tr>
        </table>

        <br>

        <H1>TASKS</H1>
        <table class="table">
            <tr>
                <th>Task Id</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
                <th>–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</th>
                <th>–î–µ–¥–ª–∞–π–Ω</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ó–∞–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>

            <tr th:each="task : ${tasks}">
                <td th:text="${task.id}"></td>
                <td th:text="${task.title}"></td>
                <td th:text="${task.description}"></td>
                <td th:text="${task.deadline}"></td>
                <td th:text="${task.status}"></td>
                <td th:text="${task.user.username}"></td>
                <td>
                    <form th:action="@{/users/updatetask/{id}(id=${task.id})}"
                          method="post">
                        <button type="submit" class="btn w-50">
                            –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
                        </button>
                    </form>
                </td>
            </tr>
        </table>
    </div>

    <a th:href="@{/}" class="btn w-25 m-1">–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥</a>

</main>

<footer>
    <p>¬©JavaRush. Arthur Kuzin. 2025 FINAL</p>
</footer>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</body>
</html>
